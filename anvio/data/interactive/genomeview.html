<!DOCTYPE html>
<html lang="en">
    <head>
        <title id="window-title">Genome View</title>
        <meta name="google" value="notranslate">
        <meta charset="UTF-8" />
        <link rel="stylesheet" href="lib/bootstrap/dist/css/bootstrap.min.css" />
        <link rel="stylesheet" type="text/css" href="./css/genomeview.css" />
        <link rel="shortcut icon" href="#">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script type="text/javascript" src="./js/genomeview.js"></script>
        <script type="text/javascript" src="./js/constants.js"></script>

        <script src="./lib/fabric/dist/fabric.js"></script>
    </head>
    <body>
        <div class="container">
            <canvas id="myCanvas" width="1200px" height="500px"></canvas>
            <div id='tooltip-body' display='none'></div>

            <div id="toggle-panel-settings" onclick="toggleSettingsPanel()">
              <span id="toggle-panel-settings-inner">&#9664;</span><span style="display: block; font-size: 11px; transform: rotate(90deg);"><u>S</u>ETTINGS</span>
            </div>

            <div id="settings-panel">
                  <div id="sidebar">
                        <div class="tab-content"></div>

                        <tr>
                          <td>Align to Gene Cluster: </td>
                          <td><input id="geneClusterInput" class="form-control input-sm" type="text" value="" size="4"></td>
                        </tr>

                        <span class="settings-header">Get Sequence for a Range or Selection</span>
                        <p class="settings-section-info">Using your mouse, you can make regional selections through the panel at the bottom of the inspection screen. Through this section you can make more precise selections by explicitly defining a range, and can get sequences for the selected region or for the entire split.</p>

                        <div id="range-box"></div>
                        <button type="button" class="btn btn-primary btn-xs" onclick="show_sequence_modal('Sequence', page_header + '\n' + sequence);">Get the entire split sequence</button><br />
                        <button type="button" class="btn btn-primary btn-xs disabled btn-selection-sequence"  onclick="show_selected_sequence();" disabled>Get sequence of selected area</button><br />


                        <span class="settings-header">Overlay GC Content</span>
                        <p class="settings-section-info">GC content may explain some variation in coverage (<a href="http://merenlab.org/2016/12/14/coverage-variation/" target="_blank">more info on wavy coverage patterns</a>). Using this section you can overlay GC content signal on your mapping results. The GC content of the reference sequence calculated as the moving average of a 'sliding window' sampled every 'step size'.</p>
                        <table id="gc-overlay" style="margin-bottom: 20px;">
                          <tbody>
                            <tr>
                              <td>Sliding window size (nt):</td>
                              <td><input type="text" class="form-control input-sm" id="gc_window_size" value="100"></td>
                            </tr>
                            <tr>
                              <td>Step size:</td>
                              <td><input type="text" class="form-control input-sm" id="gc_step_size" value="20"></td>
                            </tr>
                            <tr>
                              <td>Color:</td>
                              <td><div class="colorpicker" id="gc_overlay_color" color="#008000" style="background-color: #008000"></div></td>
                            </tr>
                          </tbody>
                        </table>

                        <button type="button" class="btn btn-primary btn-xs" onclick="applyOverlayGCContent();">Apply overlay</button>
                        <button type="button" class="btn btn-primary btn-xs" onclick="resetOverlayGCContent();">Reset overlay</button>


                        <span class="settings-header">Set/Reset Maximum Values</span>
                        <p class="settings-section-info">The y-axis on the left hand-side of each plot is automatically sclaed per sample as a function of the maximum coverage value. Using this section you can change the y-axis maximum for each sample independently, or set a single value for all samples to make coverages more comparable.</p>
                        <button type="button" class="btn btn-primary btn-xs" onclick="showSetMaxValuesDialog()" class="btn btn-outline-primary">Set maximum values</button><br />
                        <button type="button" class="btn btn-primary btn-xs" onclick="resetMaxValues()" class="btn btn-outline-primary">Reset maximum values</button><br />


                        <span class="settings-header">SNVs and IN/DELS</span>
                        <p class="settings-section-info">Show or hide single-nucleotide variant information and/or insertion/deletions anvi'o identified during the profiling of read recruitment. IN/DELs reaching the specified min sequence length will be marked in red. <a href="http://merenlab.org/2015/07/20/analyzing-variability/" target="_blank">See this</a> for more information on how to study microbial population genetics in anvi'o beyond displaying them in the context of reference sequences.</p>
                        <p class="settings-section-info" id="settings-section-info-SNV-warning"></p>
                        <table id="toggleSNVIndelTable" style="margin-bottom: 20px;">
                          <tbody>
                            <tr id="snv_picker">
                              <td><div style="width: 20px;"><input id="toggle_label_box" type="checkbox" class="layer_selectors"></div></td>
                              <td>Show Labels</td>
                            </tr>
                            <tr id="indels_picker">
                              <td><div style="width: 20px;"><input id="toggle_indel_box" type="checkbox" class="layer_selectors"></div></td>
                              <td>Show IN/DELs</td>
                            </tr>
                          </tbody>
                        </table>

                        <table id="indels" style="margin-bottom: 20px;">
                          <tbody>
                            <!-- <tr>
                              <td>Min coverage of IN/DELS to show: </td>
                              <td><input id="minIndelInput" class="form-control input-sm" type="text" value="" size="4"></td>
                            </tr> -->
                            <tr>
                              <td>Mark IN/DELs greater than sequence length: </td>
                              <td><input id="largeIndelInput" class="form-control input-sm" type="text" value="" size="4"></td>
                            </tr>
                          </tbody>
                        </table>


                        <span class="settings-header">Dynamic display features</span>
                        <p class="settings-section-info">If you zoom in enough on a region, nucleotide and codon information will appear at the bottom of your screen when applicable. Here you can toggle that feature and/or disable vertical lines that highlight the position of your mouse on the screen.</p>
                        <table style="margin-bottom: 20px;">
                          <tbody>
                            <tr>
                              <td><div style="width: 20px;"><input id="toggle_nucl_box" type="checkbox" class="layer_selectors"></div></td>
                              <td>Show nucleotides for selected sequence</td>
                            </tr>
                            <tr>
                              <td><div style="width: 20px;"><input id="toggle_highlight_box" type="checkbox" class="layer_selectors"></div></td>
                              <td>Show vertical mouse-over highlight box</td>
                            </tr>
                          </tbody>
                        </table>


                        <span class="settings-header">Genes</span>
                        <p class="settings-section-info">Change colors of genes based on their functional annotations. You can also manually color genes temporarily. First, righ-click on a gene. It will add the gene into the list below with a default color. Then, you can use the color picker next to it to set a color manually. To see the effect of changing colors, you need to press the 'Redraw Gene Arrows' button.</p>
                        <button type="button" class="btn btn-primary btn-xs" onclick="resetFunctionColors()" class="btn btn-outline-primary">Reset Function colors</button>
                        <button type="button" class="btn btn-primary btn-xs" onclick="redrawArrows()" class="btn btn-outline-primary">Redraw Gene Arrows</button>
                        <button type="button" class="btn btn-primary btn-xs" onclick="toggleShowCagsInSplit()" class="btn btn-outline-primary">Show only categories in this split</button>

                        <div class="form-group form-margin" style="margin-top: 10px; color: #000000">
                          <label id="gene_colors_label" style="padding-left: 0px;" class="col-md-4 settings-label" data-help="gene_color_order" data-original-title="" title="">Color genes by:</label>
                          <div class="col-md-8">
                            <select id="gene_color_order" stsyle="margin-bottom: 10px" class="form-control input-xs"></select>
                          </div>
                        </div>

                        <br><br><br><br>
              </div>

              <div class="btn-group sidebar-footer" role="group" style="margin-top: 5px; padding-right: 20px; padding-bottom: 5px;">
                <button type="button" class="btn btn-default btn-sm" style="width: 50%; float: left; margin-top: 5px" onclick="showLoadStateWindow();" data-help="load-state-button" data-original-title="" title=""><span class="glyphicon glyphicon-floppy-open" aria-hidden="true"></span> Load State</button>
                <button type="button" class="btn btn-default btn-sm" style="width: 50%; float: left; margin-top: 5px" onclick="showSaveStateWindow();" data-help="save-state-button" disabled-in-read-only="true" data-original-title="" title=""><span class="glyphicon glyphicon-floppy-save" aria-hidden="true"></span> Save State</button>
              </div>
            </div>

            <!-- LOAD STATE -->
            <div class="modal fade" id="modLoadState" style="display: none">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button class="close" data-dismiss="modal" type="button"><span>&times;</span></button>
                            <h4 class="modal-title">Load State</h4>
                        </div>

                        <div class="modal-body">
                            <select class="form-control" size="10" id="loadState_list" ondblclick="loadState();" onchange="$('#loadState_lastmodified').html('Last modified: ' + $('#loadState_list option:selected').attr('lastmodified')); "></select>
                            <br />
                            <div id="loadState_lastmodified">Last modified: n/a</div>
                        </div>

                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary" onclick="loadState();">Load</button>
                            <button class="btn btn-default" data-dismiss="modal" type="button">Close</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SAVE STATE -->
            <div class="modal fade" id="modSaveState" style="display: none">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button class="close" data-dismiss="modal" type="button"><span>&times;</span></button>
                            <h4 class="modal-title">Save State</h4>
                        </div>

                        <div class="modal-body">
                            <div class="form-group">
                                <select class="form-control" id="saveState_list" size="10" onchange="$('#saveState_name').val(this.value);" ondblclick="saveState();"></select>
                            </div>
                            <div class="form-group">
                                    <label class="col-md-2 settings-label label-big" for="saveState_name">Name: </label>
                                    <div class="col-md-10">
                                        <input type="text" id="saveState_name" class="form-control" />
                                    </div>
                            </div>
                        </div>

                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary" onclick="saveState();">Save</button>
                            <button class="btn btn-default" data-dismiss="modal" type="button">Close</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>
